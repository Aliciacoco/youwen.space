<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="../../main.css">
    <link rel="stylesheet" href="/css/drag-sort.css">
</head>

<body class="child-body" data-feature="drag-sort">
    <h1>拖拽排序 Drag Sort</h1>
    <p>要点<br>
        1. 分步骤实现：拖拽移动目标 → 拖动中重排其他元素 → 松手后让被拖元素归位。<br>
        2. 拖动时的重排只是视觉位移，不会改变 DOM 顺序，因此松手后需要重新获取当前节点/顺序。<br>
        3. 插入 DOM 可能导致过渡动画失效；可在插入后临时关闭过渡、清 transform、强制重排，再于下一帧恢复过渡。
    </p>
    <div class="content">
        <!-- 主体内容 -->
        <div class="drag-sort-container">
            <div class="one-unit">
                <span class="label">A</span>
            </div>
            <div class="one-unit">
                <span class="label">B</span>
            </div>
            <div class="one-unit">
                <span class="label">C</span>
            </div>
            <div class="one-unit">
                <span class="label">D</span>
            </div>
            <div class="one-unit">
                <span class="label">E</span>
            </div>
        </div>
    </div>
    <!-- 上方标签区 -->
    <div role="tablist">
        <button role="tab" aria-selected="true" aria-controls="Html" id="Html">Html</button>
        <button role="tab" aria-selected="false" aria-controls="Css" id="Css">Css</button>
        <button role="tab" aria-selected="false" aria-controls="Js" id="Js">Js</button>
    </div>
    <hr>
    <!-- 第1个面板 -->
    <div id="Html" role="tabpanel">
        <div id="editor-html" style="height:420px;border-radius:12px;overflow:hidden"></div>
    </div>
    
    <!-- 第2个面板 -->
    <div id="Css" role="tabpanel" hidden>
        <div id="editor-css" style="height:420px;border-radius:12px;overflow:hidden"></div>
    </div>
    
    <!-- 第3个面板 -->
    <div id="Js" role="tabpanel" hidden>
        <div id="editor-js" style="height:420px;border-radius:12px;overflow:hidden"></div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/monaco-editor@0.47.0/min/vs/loader.js"></script>

    <!--要展示的代码-->
    <script src="../../main.js" type="module"></script>
    <script>
        require.config({ paths: { vs: 'https://cdn.jsdelivr.net/npm/monaco-editor@0.47.0/min/vs' } });
            require(['vs/editor/editor.main'], async function () {
                // 公共选项（可选）
                const baseOpts = {
                    readOnly: true,
                    folding: true,
                    minimap: { enabled: false },
                    theme: 'vs-dark',
                    automaticLayout: true
                    // lineNumbers:'on', wordWrap:'on'  // 需要再开
                };

                // 1) HTML：直接用字符串（无需 fetch）

                // 获取当前页面源码
                const htmlPath = location.href; // 当前页面
                const htmlText = await (await fetch(htmlPath)).text();

                // 按行切分
                const lines = htmlText.split("\n");

                // 截取指定区间（第 19 ~ 36 行）
                const snippet = lines.slice(19, 36).join("\n"); // 注意数组是从 0 开始

                monaco.editor.create(document.getElementById('editor-html'), {
                    ...baseOpts,
                    value: snippet.trim(),
                    language: 'html'
                });

                // 2) CSS：从文件读（按你的实际路径改）
                const cssPath = '../../../css/drag-sort.css';
                const cssText = await (await fetch(new URL(cssPath, location.href))).text();
                monaco.editor.create(document.getElementById('editor-css'), {
                    ...baseOpts,
                    value: cssText,
                    language: 'css'
                });

                // 3) JS：从文件读（按你的实际路径改），注意 language
                const jsPath = '../../../js/drag-sort.js';
                const jsText = await (await fetch(new URL(jsPath, location.href))).text();
                monaco.editor.create(document.getElementById('editor-js'), {
                    ...baseOpts,
                    value: jsText,
                    language: 'javascript'
                });
            });
    </script>


</body>

</html>